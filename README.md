# IntegrationSystem

## Задание

1. Провести исследование формата и определить где стоимость, объем торгов и вычислить среднюю цену акции.
2. Необходимо по 3-м компаниям (Сбер, Яндекс, Газпром) сохранить котировки за 1 месяц. Помни, что не следует делать к API более 1 запроса в 5 сек — для безопасности и предотвращения блокировок или замедления трафика.
3. Котировки необходимо сохранить в текстовом документе в формате таблицы. Столбцы: название компании, объем торгов в количестве акций, объем торгов в цене акций, дата.

Примеры ссылок:
- https://iss.moex.com/iss/securities/SBER/aggregates.json?date=2022-09-21 — SBER
- https://iss.moex.com/iss/securities/YNDX/aggregates.json?date=2022-09-21 — YANDEX
- https://iss.moex.com/iss/securities/GAZP/aggregates.json?date=2022-09-21 — GAZPROM

---
## Описание
RESTful-приложение для сбора, хранения и анализа котировок акций с Московской биржи (MOEX) по компаниям Сбербанк, Яндекс, Газпром. Включает интеграцию с LLM (GigaChat) для генерации аналитических рекомендаций по котировкам за выбранный период.

## Основные возможности

- Сбор котировок по 3 компаниям за выбранный месяц с паузой между запросами (антиспам).
- Сохранение котировок в текстовые файлы в формате таблицы.
- Генерация аналитики и рекомендаций по котировкам с помощью LLM (GigaChat).
- Красивый HTML-вывод аналитики с поддержкой markdown.
- 
## Как запустить проект

1. Убедитесь, что установлен JDK 17 или выше и Maven.
2. Откройте терминал в корне проекта.
3. Соберите и запустите приложение командой:
   ```sh
   mvn spring-boot:run
   ```
   или
   ```sh
   mvn clean package
   java -jar target/IntegrationSystem-0.0.1-SNAPSHOT.jar
   ```
4. После запуска приложение будет доступно по адресу: `http://localhost:8080`

### Важно: переменные для доступа к GigaChat

В файле `application.properties` должны быть указаны:
```
gigachat.clientId=ВАШ_CLIENT_ID
gigachat.clientSecret=ВАШ_CLIENT_SECRET
```
**Не публикуйте эти значения в открытых репозиториях!**

---

## Как получить котировки за месяц

1. Откройте браузер или используйте curl/Postman.
2. Отправьте GET-запрос по адресу:
   ```
   http://localhost:8080/quotes/save?year=ГОД&month=МЕСЯЦ
   ```
   Например, чтобы получить котировки за февраль 2023 года:
   ```
   http://localhost:8080/quotes/save?year=2023&month=2
   ```
3. После выполнения запроса файл с котировками будет сохранён в папке `src/main/resources` с именем:
   ```
   quotes_ГОД-МЕСЯЦ.txt
   ```
   Пример: `quotes_2023-02.txt`

---

## Как получить аналитику и рекомендации LLM

1. Откройте браузер и перейдите по адресу:
   ```
   http://localhost:8080/analytics/recommendation?year=ГОД&monthStart=НАЧАЛЬНЫЙ_МЕСЯЦ&monthEnd=КОНЕЧНЫЙ_МЕСЯЦ
   ```
   Пример: аналитика за октябрь 2023:
   ```
   http://localhost:8080/analytics/recommendation?year=2023&monthStart=10&monthEnd=10
   ```
2. На странице отобразится красиво оформленный отчёт с рекомендациями от LLM (GigaChat) с поддержкой markdown (заголовки, списки, выделения и т.д.).

---

## Примечания
- В одном файле будут котировки сразу по трём компаниям: SBER, YNDX, GAZP.
- Между запросами к одной и той же компании выдерживается пауза 5 секунд.
- Для работы аналитики необходимы валидные clientId и clientSecret для GigaChat API.
- Если порт или путь отличается — используйте ваш актуальный адрес.

